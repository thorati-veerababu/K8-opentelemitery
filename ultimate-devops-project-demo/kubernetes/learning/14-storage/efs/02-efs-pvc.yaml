# ============================================================
# EFS PERSISTENT VOLUME CLAIM
# ============================================================
#
# ğŸ“š KEY DIFFERENCE: AccessMode!
#
# EBS PVC:
#   accessModes: [ReadWriteOnce]     â† Only ONE node
#
# EFS PVC:
#   accessModes: [ReadWriteMany]     â† MANY nodes! âœ…
#
# ============================================================

apiVersion: v1
kind: PersistentVolumeClaim

metadata:
  name: efs-claim
  labels:
    app: efs-demo
    type: shared-storage

spec:
  # ============================================================
  # ACCESS MODES - The key feature of EFS!
  # ============================================================
  accessModes:
    - ReadWriteMany                   # ğŸ‘ˆ RWX = Multiple pods can read/write!
                                       #
                                       # Comparison:
                                       # â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       # â”‚ ReadWriteOnce (RWO) - EBS          â”‚
                                       # â”‚   â†’ 1 node can mount               â”‚
                                       # â”‚   â†’ Good for databases             â”‚
                                       # â”‚                                    â”‚
                                       # â”‚ ReadWriteMany (RWX) - EFS          â”‚
                                       # â”‚   â†’ Many nodes can mount           â”‚
                                       # â”‚   â†’ Good for shared files          â”‚
                                       # â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  # ============================================================
  # STORAGE CLASS
  # ============================================================
  storageClassName: efs-sc            # ğŸ‘ˆ References our EFS StorageClass

  # ============================================================
  # RESOURCES - Storage request
  # ============================================================
  resources:
    requests:
      storage: 5Gi                    # ğŸ‘ˆ For EFS, this is informational
                                       #    EFS doesn't pre-allocate space
                                       #    You only pay for what you use!
                                       #
                                       # EBS charges for: 5Gi provisioned
                                       # EFS charges for: actual bytes used

# ============================================================
# ğŸ’° COST COMPARISON (ap-south-1 region):
# ============================================================
#
# EBS gp3 100GB: ~$8/month (pay for provisioned)
# EFS 100GB:     ~$30/month (pay for used, but higher per-GB)
#
# Use EFS when:
#   âœ… Multiple pods need same data
#   âœ… Data needs to survive node failures
#   âœ… Cross-AZ access required
#
# Use EBS when:
#   âœ… Single pod access
#   âœ… High IOPS needed (databases)
#   âœ… Cost optimization
#
# ============================================================
